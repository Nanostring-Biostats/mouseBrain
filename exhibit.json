{"PixelsPerMicron":2.5043, "Images": [
    {"Name": "i0", "Description": "", "Path": "images/mousebrain", "Width": 32768, "Height": 32768, "MaxLevel": 5}], 
    "Header": "![image](img/SOA_logo.png)", 
    "Rotation": 180, 
    "Layout": {"Grid": [["i0"]]},
    "Appendix": "For more information on NanoString GeoMx technology visit [**our website**](https://www.nanostring.com/products/geomx-digital-spatial-profiler/geomx-dsp-overview/).\n\nDetails of the performance of WTA have been [**published**](https://doi.org/10.1101/2021.09.29.462442).\n\nMinerva is an open-source software package that was developed by Laboratory of Systems Pharmacology at Harvard University and is available [**here**](https://github.com/labsyspharm/minerva-story/wiki). We would like to thank Jeremy Muhlich and John Thomas Hoffer for assistance in enabling Minerva features to support the Spatial Organ Atlas.\n\nSources:\n\nRashid R, Chen YA, Hoffer J, Muhlich JL, Lin JR, Krueger R, Pfister H, Mitchell R, Santagata S, and Sorger PK. Interpretative guides for interacting with tissue atlas and digital pathology data using the Minerva browser. BioRxiv. (2020) [https://doi.org/10.1101/2020.03.27.001834](https://doi.org/10.1101/2020.03.27.001834)\n\nHoffer J, Rashid R, Muhlich JL, Chen, YA, Russell D, Ruokonen J, Krueger R, Pfister H, Santagata S, Sorger PK. (2020). Minerva: a light-weight, narrative image browser for multiplexed tissue images. Journal of Open Source Software, 5(54), 2579, [https://doi.org/10.21105/joss.02579](https://doi.org/10.21105/joss.02579)\n\nIllustrations  by Dave Carlson/[CarlsonStockArt.com](https://www.carlsonstockart.com/)\n\nFOR RESEARCH USE ONLY. Not for use in diagnostic procedures",
    "Stories": [
        {"Name": "", 
        "Description": "Welcome to the [**Spatial Organ Atlas (SOA)**](https://www.nanostring.com/spatial-organ-atlas) Mouse Brain Demonstration.\n\nThe SOA is a database for whole transcriptome spatial profiles of functional components of tissues from human and mouse generated with the GeoMxÂ® Digital Spatial Profiler. All the data in the SOA is downloadable, including [**this mouse brain sample (#004)**](https://www.nanostring.com/products/geomx-digital-spatial-profiler/spatial-organ-atlas/mouse-brain/).\n\nUsing [**Minerva**](https://github.com/labsyspharm/minerva-story/wiki), we will show you how the imaging and molecular data combine to give you a comprehensive profile of the tissue architecture and biology.\n\nClick around to explore on your own. \n\nHints:\n* Zoom and pan the image via the mouse/trackpad.\n* Open and close the left- and right-hand menus by clicking on < or >.\n* See results in the left-hand menu and click on the selectable regions to zoom to the featured area of the tissue.\n* Turn channels on and off with the right-hand menu.", 
        "Waypoints": [
        {
            "Name": "Gross Brain Morphology", 
            "Description": "(Mouse brain gross morphology cartoon)", 
            "Arrows": [], 
            "Overlays": [], 
            "Group": "All markers", 
            "Masks": ["Amygdala", "Amygdala - NeuN+", "Amygdala - Neuropil", "Cortical layer I", "Cortical layer II/III", "Cortical layer II/III - NeuN+", "Cortical layer II/III - Neuropil", "Cortical layer IV", "Cortical layer IV - NeuN+", "Cortical layer IV - Neuropil", "Cortical layer V", "Cortical layer V - NeuN+", "Cortical layer V - Neuropil", "Cortical layer VI", "Cortical layer VI - NeuN+", "Cortical layer VI - Neuropil", "Caudoputamen", "Caudoputamen - NeuN+", "Caudoputamen - Neuropil", "Choroid plexus", "Hippocampus CA1", "Hippocampus CA2", "Hippocampus CA3", "Hippocampus dentate gyrus", "Hypothalamus", "Ventromedial hypothalamic nucleus", "Corticospinal tract", "Lateral habenula", "Medial habenula", "Thalamic paraventricular nucleus", "Mediodorsal thalamus", "Thalamic ventral posteromedial nucleus", "Thalamus"], 
            "ActiveMasks": ["Amygdala", "Amygdala - NeuN+", "Amygdala - Neuropil", "Cortical layer I", "Cortical layer II/III", "Cortical layer II/III - NeuN+", "Cortical layer II/III - Neuropil", "Cortical layer IV", "Cortical layer IV - NeuN+", "Cortical layer IV - Neuropil", "Cortical layer V", "Cortical layer V - NeuN+", "Cortical layer V - Neuropil", "Cortical layer VI", "Cortical layer VI - NeuN+", "Cortical layer VI - Neuropil", "Caudoputamen", "Caudoputamen - NeuN+", "Caudoputamen - Neuropil", "Choroid plexus", "Hippocampus CA1", "Hippocampus CA2", "Hippocampus CA3", "Hippocampus dentate gyrus", "Hypothalamus", "Ventromedial hypothalamic nucleus", "Corticospinal tract", "Lateral habenula", "Medial habenula", "Thalamic paraventricular nucleus", "Mediodorsal thalamus", "Thalamic ventral posteromedial nucleus", "Thalamus"], 
            "Zoom": 0.42730637009654243, 
            "Pan": [0.5, 0.4999999999999999]
        },
        {
            "Name": "Linking Molecular and Imaging Data", 
            "Description": "(# of genes with expression over LOQ)", 
            "Arrows": [], 
            "Overlays": [], 
            "Group": "All markers", 
            "Masks": ["Amygdala", "Amygdala - NeuN+", "Amygdala - Neuropil", "Cortical layer I", "Cortical layer II/III", "Cortical layer II/III - NeuN+", "Cortical layer II/III - Neuropil", "Cortical layer IV", "Cortical layer IV - NeuN+", "Cortical layer IV - Neuropil", "Cortical layer V", "Cortical layer V - NeuN+", "Cortical layer V - Neuropil", "Cortical layer VI", "Cortical layer VI - NeuN+", "Cortical layer VI - Neuropil", "Caudoputamen", "Caudoputamen - NeuN+", "Caudoputamen - Neuropil", "Choroid plexus", "Hippocampus CA1", "Hippocampus CA2", "Hippocampus CA3", "Hippocampus dentate gyrus", "Hypothalamus", "Ventromedial hypothalamic nucleus", "Corticospinal tract", "Lateral habenula", "Medial habenula", "Thalamic paraventricular nucleus", "Mediodorsal thalamus", "Thalamic ventral posteromedial nucleus", "Thalamus"], 
            "ActiveMasks": ["Amygdala", "Amygdala - NeuN+", "Amygdala - Neuropil", "Cortical layer I", "Cortical layer II/III", "Cortical layer II/III - NeuN+", "Cortical layer II/III - Neuropil", "Cortical layer IV", "Cortical layer IV - NeuN+", "Cortical layer IV - Neuropil", "Cortical layer V", "Cortical layer V - NeuN+", "Cortical layer V - Neuropil", "Cortical layer VI", "Cortical layer VI - NeuN+", "Cortical layer VI - Neuropil", "Caudoputamen", "Caudoputamen - NeuN+", "Caudoputamen - Neuropil", "Choroid plexus", "Hippocampus CA1", "Hippocampus CA2", "Hippocampus CA3", "Hippocampus dentate gyrus", "Hypothalamus", "Ventromedial hypothalamic nucleus", "Corticospinal tract", "Lateral habenula", "Medial habenula", "Thalamic paraventricular nucleus", "Mediodorsal thalamus", "Thalamic ventral posteromedial nucleus", "Thalamus"], 
            "Zoom": 0.415575667912783, 
            "Pan": [0.49999999999999956, 0.36650119957430205],
            "MaskAndPan": {"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}, "background": null}, "width": "container",
            "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
            "data": {
                "url": "data/waypoint3secondary.csv"
            },
            "mark": {
                "type": "point",
                "filled": true,
                "stroke": "white",
                "strokeWidth": 0.5,
                "size": 80
            },
            "encoding": {
                "x": {
                    "field": "x_axis",
                    "type": "quantitative",
                    "axis": {
                        "labelExpr": "datum.label == 1 ? 'Amygdala' : datum.label == 2 ? 'Amygdala - NeuN+' : datum.label == 3 ? 'Amygdala - Neuropil' : datum.label == 4 ? 'Caudoputamen' : datum.label == 5 ? 'Caudoputamen - NeuN+' : datum.label == 6 ? 'Caudoputamen - Neuropil' : datum.label == 7 ? 'Cortex' : datum.label == 8 ? 'Cortex - NeuN+' : datum.label == 9 ? 'Cortex - Neuropil' : datum.label == 10 ? 'Epithalamus' : datum.label == 11 ? 'Hippocampus' : datum.label == 12 ? 'Hypothalamus' : datum.label == 13 ? 'Corticospinal tract' : datum.label == 14 ? 'Thalamus' : datum.label == 15 ? 'Choroid plexus' : null",
                        "labelAngle": -90,
                        "tickCount": 12,
                        "grid": false
                    },
                    "scale": {"domain": [0, 16]},
                    "title": null
                },
                "y": {
                    "field": "Genes Detected",
                    "type": "quantitative",
                    "title": "Genes Detected,# > LOQ"
                },
                "shape": {
                    "field": "Cortical Layer", 
                    "type": "nominal",
                    "legend": {
                        "orient": "bottom",
                        "direction": "vertical",
                        "symbolFillColor": "white"
                    },
                    "scale": {
                        "domain": ["Layer I", "Layer II/III", "Layer IV", "Layer V", "Layer VI"],
                        "range": ["square", "cross", "diamond", "triangle-up", "triangle-down"]
                    }
                },
                "color": {
                    "field": "SecondaryLocation",
                    "type": "nominal",
                    "legend": {
                        "orient": "bottom",
                        "direction": "vertical"
                    },
                    "title": "ROI Category",
                    "scale": {
                        "domain": ["NeuN+", "Neuropil", "Amygdala", "Caudoputamen", "Cortical layer I", "Cortical layer II/III", "Cortical layer IV", "Cortical layer V", "Cortical layer VI", "Lateral habenula", "Medial habenula", "Hippocampus CA1", "Hippocampus CA2", "Hippocampus CA3", "Hippocampus dentate gyrus", "Hypothalamus", "Choroid plexus", "Ventromedial hypothalamic nucleus", "Corticospinal tract",  "Thalamic paraventricular nucleus", "Mediodorsal thalamus", "TVPN", "Thalamus"],
                        "range": ["#f0e442", "#d55e00", "#5c581d", "#a34902", "#ccf2f7", "#90cef0", "#37a7e5", "#005b8e", "#002e48", "#737373", "#cbcbcb", "#b9f9e8", "#00ffba", "#009e73", "#01513b", "#beb532", "#fdae70", "#fff9ad", "#323232", "#784a64", "#be719c", "#f093c7", "#fec4e4"]
                    }
                },
            "tooltip": [
                {"field": "Genes Detected", "type": "quantitative"},
                {"field": "type", "type": "nominal", "title": "ROI cateogry"}
            ]
            }
        }
        }, 
        {
            "Name": "Global Cell Type Deconvolution", 
            "Description": "(cell type with all ROI categories)", 
            "Arrows": [], 
            "Overlays": [], 
            "Group": "All markers", 
            "Masks": ["Amygdala", "Amygdala - NeuN+", "Amygdala - Neuropil", "Cortical layer I", "Cortical layer II/III", "Cortical layer II/III - NeuN+", "Cortical layer II/III - Neuropil", "Cortical layer IV", "Cortical layer IV - NeuN+", "Cortical layer IV - Neuropil", "Cortical layer V", "Cortical layer V - NeuN+", "Cortical layer V - Neuropil", "Cortical layer VI", "Cortical layer VI - NeuN+", "Cortical layer VI - Neuropil", "Caudoputamen", "Caudoputamen - NeuN+", "Caudoputamen - Neuropil", "Choroid plexus", "Hippocampus CA1", "Hippocampus CA2", "Hippocampus CA3", "Hippocampus dentate gyrus", "Hypothalamus", "Ventromedial hypothalamic nucleus", "Corticospinal tract", "Lateral habenula", "Medial habenula", "Thalamic paraventricular nucleus", "Mediodorsal thalamus", "Thalamic ventral posteromedial nucleus", "Thalamus"], 
            "ActiveMasks": ["Amygdala", "Amygdala - NeuN+", "Amygdala - Neuropil", "Cortical layer I", "Cortical layer II/III", "Cortical layer II/III - NeuN+", "Cortical layer II/III - Neuropil", "Cortical layer IV", "Cortical layer IV - NeuN+", "Cortical layer IV - Neuropil", "Cortical layer V", "Cortical layer V - NeuN+", "Cortical layer V - Neuropil", "Cortical layer VI", "Cortical layer VI - NeuN+", "Cortical layer VI - Neuropil", "Caudoputamen", "Caudoputamen - NeuN+", "Caudoputamen - Neuropil", "Choroid plexus", "Hippocampus CA1", "Hippocampus CA2", "Hippocampus CA3", "Hippocampus dentate gyrus", "Hypothalamus", "Ventromedial hypothalamic nucleus", "Corticospinal tract", "Lateral habenula", "Medial habenula", "Thalamic paraventricular nucleus", "Mediodorsal thalamus", "Thalamic ventral posteromedial nucleus", "Thalamus"], 
            "Zoom": 0.41152628245725137, 
            "Pan": [0.5, 0.5000000000000001],
            "MaskAndPan": {"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}, "background": null},
            "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
            "layer": 
            [{
               "mark": "bar",
               "data": {"url": "data/global_cell_type_deconvolution.csv"},
               "width": "container",
               "encoding": {
                     "x": {
                           "field": "Proportion", 
                           "type": "quantitative", 
                           "stack": "normalize", 
                           "title": "Proportion of Cell Type"
                     },
                     "y": {
                           "field": "Sample_ID", 
                           "type": "nominal", 
                           "title": null,
                           "axis": {
                               "labels": false,
                               "ticks": false
                           },
                           "sort": null
                     },
                     "color": {
                           "field": "Cell_type", 
                           "type": "nominal",
                           "legend": {"orient": "bottom", "direction": "vertical", "offset": 1800}, 
                           "title": "Cell Type",
                           "sort":null
                           },
                    "order": {
                            "field": "Order"
                        },
                   "tooltip": {
                       "field": "Cell_type", "type":"nominal"
                       }    
                     }
                     
            },
            {
            "data": {
                "values": [
                    {"Sample_ID": "ROI", "order": "X", "type": "Choroid plexus", "percentage": 0.033, "name": "Choroid plexus"},
                    {"Sample_ID": "ROI", "order": "W", "type": "Corticospinal tract", "percentage": 0.033, "name": "Corticospinal tract"},
                    {"Sample_ID": "ROI", "order": "V", "type": "Hippocampus CA1", "percentage": 0.0215, "name": "Hippocampus CA1"},
                    {"Sample_ID": "ROI", "order": "U", "type": "Hippocampus CA2", "percentage": 0.011, "name": "Hippocampus CA2"},
                    {"Sample_ID": "ROI", "order": "T", "type": "Hippocampus CA3", "percentage": 0.033, "name": "Hippocampus CA3"},
                    {"Sample_ID": "ROI", "order": "S", "type": "Hippocampus dentate gyrus", "percentage": 0.033, "name": "Hippocampus dentate gyrus"},
                    {"Sample_ID": "ROI", "order": "R", "type": "Amygdala", "percentage": 0.033, "name": "Amygdala"},
                    {"Sample_ID": "ROI", "order": "Q", "type": "Amygdala - NeuN+", "percentage": 0.033, "name": "NeuN+"},
                    {"Sample_ID": "ROI", "order": "P", "type": "Amygdala - Neuropil", "percentage": 0.033, "name": "Neuropil"},
                    {"Sample_ID": "ROI", "order": "O", "type": "Caudoputamen", "percentage": 0.033, "name": "Caudoputamen"},
                    {"Sample_ID": "ROI", "order": "N", "type": "Caudoputamen - NeuN+", "percentage": 0.033, "name": "NeuN+"},
                    {"Sample_ID": "ROI", "order": "M", "type": "Caudoputamen - Neuropil", "percentage": 0.033, "name": "Neuropil"},
                    {"Sample_ID": "ROI", "order": "L", "type": "Hypothalamus", "percentage": 0.033, "name": "Hypothalamus"},
                    {"Sample_ID": "ROI", "order": "K", "type": "Ventromedial hypothalamic nucleus", "percentage": 0.0215, "name": "Ventromedial hypothalamic nucleus"},
                    {"Sample_ID": "ROI", "order": "J", "type": "Thalamus", "percentage": 0.033, "name": "Thalamus"},
                    {"Sample_ID": "ROI", "order": "I", "type": "Mediodorsal thalamus", "percentage": 0.033, "name": "Mediodorsal thalamus"},
                    {"Sample_ID": "ROI", "order": "H", "type": "Thalamic paraventricular nucleus", "percentage": 0.0215, "name": "Thalamic paraventricular nucleus"},
                    {"Sample_ID": "ROI", "order": "G", "type": "Thalamic ventral posteromedial nucleus", "percentage": 0.033, "name": "Thalamic ventral posteromedial nucleus"},
                    {"Sample_ID": "ROI", "order": "F", "type": "Lateral habenula", "percentage": 0.0224, "name": "Lateral habenula"},
                    {"Sample_ID": "ROI", "order": "E", "type": "Medial habenula", "percentage": 0.0224, "name": "Medial habenula"},
                    {"Sample_ID": "ROI", "order": "D", "type": "Cortical layer I", "percentage": 0.0215, "name": "Cortical layer I"},
                    {"Sample_ID": "ROI", "order": "C", "type": "Cortical layer II/III", "percentage": 0.033, "name": "Cortical layer II/III"},
                    {"Sample_ID": "ROI", "order": "B", "type": "Cortical layer II/III - NeuN+", "percentage": 0.033, "name": "NeuN+"},
                    {"Sample_ID": "ROI", "order": "A", "type": "Cortical layer II/III - Neuropil", "percentage": 0.033, "name": "Neuropil"},
                    {"Sample_ID": "ROI", "order": "9", "type": "Cortical layer IV", "percentage": 0.033, "name": "Cortical layer IV"},
                    {"Sample_ID": "ROI", "order": "8", "type": "Cortical layer IV - NeuN+", "percentage": 0.033, "name": "NeuN+"},
                    {"Sample_ID": "ROI", "order": "7", "type": "Cortical layer IV - Neuropil", "percentage": 0.033, "name": "Neuropil"},
                    {"Sample_ID": "ROI", "order": "6", "type": "Cortical layer V", "percentage": 0.033, "name": "Cortical layer V"},
                    {"Sample_ID": "ROI", "order": "5", "type": "Cortical layer V - NeuN+", "percentage": 0.033, "name": "NeuN+"},
                    {"Sample_ID": "ROI", "order": "4", "type": "Cortical layer V - Neuropil", "percentage": 0.033, "name": "Neuropil"},
                    {"Sample_ID": "ROI", "order": "3", "type": "Cortical layer VI", "percentage": 0.033, "name": "Cortical layer VI"},
                    {"Sample_ID": "ROI", "order": "2", "type": "Cortical layer VI - NeuN+", "percentage": 0.033, "name": "NeuN+"},
                    {"Sample_ID": "ROI", "order": "1", "type": "Cortical layer VI - Neuropil", "percentage": 0.033, "name": "Neuropil"}
                ]},
                    "mark": {"type": "bar", "xOffset": -7},
                    "width": 7,
                    "height": 1820,
                    "encoding": {
                        "y": {
                                "field": "percentage", 
                                "type": "quantitative",
                                "axis": {
                                "labels": false,
                                "ticks": false
                                },
                                "title": null
                        },
                        "x": {
                                "field": "Sample_ID", 
                                "type": "nominal",     
                                "title": null,
                                "axis": {
                                "labels": false,
                                "ticks": false
                                }
                            },
                        "color": {
                            "field": "name", 
                            "type": "nominal",
                            "sort": null,
                            "legend": {"orient": "bottom", "direction": "vertical", "title": "ROI Category"},
                            "scale": {
                                "domain": ["NeuN+", "Neuropil", "Choroid plexus", "Corticospinal tract", "Hippocampus CA1", "Hippocampus CA2", "Hippocampus CA3", "Hippocampus dentate gyrus", "Amygdala", "Caudoputamen", "Hypothalamus", "Ventromedial hypothalamic nucleus", "Thalamus", "Mediodorsal thalamus", "Thalamic paraventricular nucleus", "Thalamic ventral posteromedial nucleus", "Lateral habenula", "Medial habenula", "Cortical layer I", "Cortical layer II/III", "Cortical layer IV", "Cortical layer V", "Cortical layer VI"],
                                "range": ["#f0e442", "#d55e00", "#fdae70", "#323232", "#b9f9e8", "#00ffba", "#009e73", "#01513b", "#5c581d", "#a34902", "#beb532", "#fff9ad", "#fec4e4", "#be719c", "#784a64", "#f093c7", "#737373", "#cbcbcb", "#ccf2f7", "#90cef0", "#37a7e5", "#005b8e", "#002e48"]}
                        },
                        "tooltip": {
                            "field": "type", "type":"nominal"
                        },         
                        "order": {"field": "order"}
                    }
            }],
          "resolve": {"scale": {"color": "independent"}}
        }
        }, 
        {
            "Name": "Spatial mapping of Segmented ROIs", 
            "Description": "(heatmap of NeuN+ vs Neuropil pathways)", 
            "Arrows": [], 
            "Overlays": [], 
            "Group": "Nuclei", 
            "Masks": ["Amygdala - NeuN+", "Amygdala - Neuropil", "Cortical layer II/III - NeuN+", "Cortical layer II/III - Neuropil", "Cortical layer IV - NeuN+", "Cortical layer IV - Neuropil", "Cortical layer V - NeuN+", "Cortical layer V - Neuropil", "Cortical layer VI - NeuN+", "Cortical layer VI - Neuropil", "Caudoputamen - NeuN+", "Caudoputamen - Neuropil"], 
            "ActiveMasks": ["Amygdala - NeuN+", "Amygdala - Neuropil", "Cortical layer II/III - NeuN+", "Cortical layer II/III - Neuropil", "Cortical layer IV - NeuN+", "Cortical layer IV - Neuropil", "Cortical layer V - NeuN+", "Cortical layer V - Neuropil", "Cortical layer VI - NeuN+", "Cortical layer VI - Neuropil", "Caudoputamen - NeuN+", "Caudoputamen - Neuropil"], 
            "Zoom": 0.493396674584323, 
            "Pan": [0.5000000000000014, 0.4883626682587922],
            "multipleMasksAndPan": {"config": {"axis": {"domain":false}, "view": {"continuousWidth": 400, "continuousHeight": 300}, "background": null}, "width": "container",
            "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
            "layer": [{
                "data": {"url": "data/wpt4_pathway_heatmap.csv"},
                "mark": "rect",
                "encoding": {
                    "x": {
                        "field": "ROI",
                        "type": "nominal",
                        "title": null,
                        "sort": null,
                        "axis": {
                            "labels": false,
                            "ticks": false
                        }
                    },
                    "y": {
                        "field": "path",
                        "type": "nominal",
                        "sort": null,
                        "title": null
                    },
                    "color": {
                        "field": "path_value",
                        "bin": {"binned": true},
                        "scale": {"range": ["#7D26CD", "#6B20AF", "#591B92", "#471575", "#351057", "#230A3A", "#11051D", "#000000", "#212100", "#434300", "#656500", "#888800", "#AAAA00", "#CBCB00", "#EEEE00"]},
                        "legend": {"orient": "top"}, 
                        "title": null
                    },
                    "tooltip": {
                        "field": "full_pathway_name",
                        "type": "nominal"
                    }
                }
            },
        {
            "data": {
                "values":[
                    {"bar": "one", "order": "1", "name": "Cortical layer IV", "type": "Cortical layer IV - Neuropil", "percentage": 0.0277},
                    {"bar": "one", "order": "2", "name": "Caudoputamen", "type": "Caudoputamen - NeuN+", "percentage": 0.083},
                    {"bar": "one", "order": "3", "name": "Cortical layer II/III", "type": "Cortical layer II/III - NeuN+", "percentage": 0.0277},
                    {"bar": "one", "order": "4", "name": "Cortical layer V", "type": "Cortical layer V - NeuN+", "percentage": 0.0277},
                    {"bar": "one", "order": "5", "name": "Cortical layer VI", "type": "Cortical layer VI - NeuN+", "percentage": 0.056},
                    {"bar": "one", "order": "6", "name": "Cortical layer V", "type": "Cortical layer V - NeuN+", "percentage": 0.056},
                    {"bar": "one", "order": "7", "name": "Cortical layer VI", "type": "Cortical layer VI - NeuN+", "percentage": 0.0277},
                    {"bar": "one", "order": "8", "name": "Cortical layer II/III", "type": "Cortical layer II/III - NeuN+", "percentage": 0.056},
                    {"bar": "one", "order": "9", "name": "Cortical layer IV", "type": "Cortical layer IV - NeuN+", "percentage": 0.0277},
                    {"bar": "one", "order": "A", "name": "Amygdala", "type": "Amygdala - NeuN+", "percentage": 0.083},
                    {"bar": "one", "order": "B", "name": "Cortical layer IV", "type": "Cortical layer IV - NeuN+", "percentage": 0.056},
                    {"bar": "one", "order": "C", "name": "Cortical layer VI", "type": "Cortical layer VI - Neuropil", "percentage": 0.0277},
                    {"bar": "one", "order": "D", "name": "Cortical layer V", "type": "Cortical layer V - Neuropil", "percentage": 0.0277},
                    {"bar": "one", "order": "E", "name": "Cortical layer II/III", "type": "Cortical layer II/III - Neuropil", "percentage": 0.0277},
                    {"bar": "one", "order": "F", "name": "Cortical layer V", "type": "Cortical layer V - Neuropil", "percentage": 0.0277},
                    {"bar": "one", "order": "G", "name": "Cortical layer II/III", "type": "Cortical layer II/III - Neuropil", "percentage": 0.0277},
                    {"bar": "one", "order": "H", "name": "Cortical layer VI", "type": "Cortical layer VI - Neuropil", "percentage": 0.0277},
                    {"bar": "one", "order": "I", "name": "Cortical layer IV", "type": "Cortical layer IV - Neuropil", "percentage": 0.0277},
                    {"bar": "one", "order": "J", "name": "Cortical layer II/III", "type": "Cortical layer II/III - Neuropil", "percentage": 0.0277},
                    {"bar": "one", "order": "K", "name": "Cortical layer IV", "type": "Cortical layer IV - Neuropil", "percentage": 0.0277},
                    {"bar": "one", "order": "L", "name": "Amygdala", "type": "Amygdala - Neuropil", "percentage": 0.056},
                    {"bar": "one", "order": "M", "name": "Caudoputamen", "type": "Caudoputamen - Neuropil", "percentage": 0.0277},
                    {"bar": "one", "order": "N", "name": "Cortical layer V", "type": "Cortical layer V - Neuropil", "percentage": 0.0277},
                    {"bar": "one", "order": "O", "name": "Caudoputamen", "type": "Caudoputamen - Neuropil", "percentage": 0.0277},
                    {"bar": "one", "order": "P", "name": "Cortical layer VI", "type": "Cortical layer VI - Neuropil", "percentage": 0.0277},
                    {"bar": "one", "order": "Q", "name": "Amygdala", "type": "Amygdala - Neuropil", "percentage": 0.0277},
                    {"bar": "one", "order": "R", "name": "Caudoputamen", "type": "Caudoputamen - Neuropil", "percentage": 0.0277}
                ]
            },
            "height": 10,
            "mark": {
                "type": "bar",
                "yOffset": 300
            },
            "encoding": {
                "x": {
                    "field": "percentage",
                    "type": "quantitative",
                    "axis": {
                        "labels": false,
                        "ticks": false
                    },
                    "title": null
                },
                "y": {
                    "field": "bar",
                    "type": "nominal",
                    "title": null,
                    "axis": {
                        "labels": false,
                        "ticks": false
                    }
                },
                "tooltip": {"field": "type", "type": "nominal", "title": "ROI Cateogry"},
                "color": {
                    "field": "name",
                    "type": "nominal",
                    "sort":null,
                    "legend": {
                        "title": "Histological structure",
                        "offset":325,
                        "orient": "bottom",
                        "direction": "vertical"
                    },
                    "scale": {
                        "domain": ["Amygdala", "Caudoputamen", "Cortical layer I", "Cortical layer II/III", "Cortical layer IV", "Cortical layer V", "Cortical layer VI"],
                        "range": [ "#5c581d", "#a34902", "#ccf2f7", "#90cef0", "#37a7e5", "#005b8e", "#002e48"]}
                },
                "order": {"field": "order"}
                }
        },
        {
            "data": {
                "values":[
                    {"bar": "two", "order": "A", "segmentation": "Neuoropil", "type": "Cortical layer IV - Neuropil", "percentage": 0.0277778},
                    {"bar": "two", "order": "B", "segmentation": "NeuN+", "type": "Cortical layer II/III - NeuN+,Caudoputamen - NeuN+,Cortical layer V - NeuN+,Cortical layer IV - NeuN+,Cortical layer VI - NeuN+,Amygdala - NeuN+", "percentage": 0.5},
                    {"bar": "two", "order": "C", "segmentation": "Neuoropil", "type": "Cortical layer II/III - Neuropil,Caudoputamen - Neuropil,Cortical layer V - Neuropil,Cortical layer IV - Neuropil,Cortical layer VI - Neuropil,Amygdala - Neuropil", "percentage": 0.4722222}
                ]
            },
            "mark": {
                "type": "bar",
                "yOffset": 308
            },
            "height": 10,
            "encoding": {
                "x": {
                    "field": "percentage",
                    "type": "quantitative",
                    "axis": {
                        "labels": false,
                        "ticks": false
                    },
                    "title": null
                },
                "y": {
                    "field": "bar",
                    "type": "nominal",
                    "title": null,
                    "axis": {
                        "labels": false,
                        "ticks": false
                    }
                },
                "color": {
                    "field": "segmentation",
                    "type": "nominal",
                    "sort":null,
                    "legend": {
                        "title": "Segmentation",
                        "offset":325,
                        "orient": "bottom",
                        "direction": "vertical"
                    },
                    "scale": {
                        "domain": ["Neuoropil", "NeuN+"],
                        "range": ["#d55e00", "#f0e442"]
                    }
                },
                "order": {"field": "order"}
                }
        }],
        "resolve": {"scale": {"y": "independent"}}
        }
        }, 
        {
            "Name": "Cortex Morphology", 
            "Description": "(cartoon of the cortical layers)",
             "Arrows": [], 
             "Overlays": [], 
             "Group": "All markers", 
             "Masks": ["Cortical layer I", "Cortical layer II/III", "Cortical layer II/III - NeuN+", "Cortical layer II/III - Neuropil", "Cortical layer IV", "Cortical layer IV - NeuN+", "Cortical layer IV - Neuropil", "Cortical layer V", "Cortical layer V - NeuN+", "Cortical layer V - Neuropil", "Cortical layer VI", "Cortical layer VI - NeuN+", "Cortical layer VI - Neuropil"], 
             "ActiveMasks": ["Cortical layer I", "Cortical layer II/III", "Cortical layer II/III - NeuN+", "Cortical layer II/III - Neuropil", "Cortical layer IV", "Cortical layer IV - NeuN+", "Cortical layer IV - Neuropil", "Cortical layer V", "Cortical layer V - NeuN+", "Cortical layer V - Neuropil", "Cortical layer VI", "Cortical layer VI - NeuN+", "Cortical layer VI - Neuropil"], 
             "Zoom": 1.6461051298290055, 
             "Pan": [0.29341332250640967, 0.6050970198106782]
        }, 
        {
            "Name": "Segregation within Cortical Layers", 
            "Description": "", 
            "Arrows": [], 
            "Overlays": [], 
            "Group": "All markers", 
            "Masks": ["Cortical layer I", "Cortical layer II/III", "Cortical layer II/III - NeuN+", "Cortical layer II/III - Neuropil", "Cortical layer IV", "Cortical layer IV - NeuN+", "Cortical layer IV - Neuropil", "Cortical layer V", "Cortical layer V - NeuN+", "Cortical layer V - Neuropil", "Cortical layer VI", "Cortical layer VI - NeuN+", "Cortical layer VI - Neuropil"], 
            "ActiveMasks": ["Cortical layer I", "Cortical layer II/III", "Cortical layer II/III - NeuN+", "Cortical layer II/III - Neuropil", "Cortical layer IV", "Cortical layer IV - NeuN+", "Cortical layer IV - Neuropil", "Cortical layer V", "Cortical layer V - NeuN+", "Cortical layer V - Neuropil", "Cortical layer VI", "Cortical layer VI - NeuN+", "Cortical layer VI - Neuropil"], 
            "Zoom": 1.6461051298290055, 
            "Pan": [0.3068811072299535, 0.6243367688909288],
            "MaskAndPan": {"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}, "background": null}, "width": "container",
            "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
            "data": {"url": "data/wpt6_cortex_pca.csv"},
            "mark": {"type": "point", "filled": true, "size": 100, "stroke": "white", "strokeWidth": 0.5},
            "encoding": {
                "x": {
                    "field": "x_axis",
                    "type": "quantitative",
                    "title": "PCA 1 (26%)"
                },
                "y": {
                    "field": "y_axis",
                    "type": "quantitative",
                    "title": "PCA 2 (6%)"
                },
                "shape": {
                    "field": "layer", 
                    "type": "nominal",
                    "legend": {
                        "orient": "bottom",
                        "direction": "vertical",
                        "symbolFillColor": "white"
                    },
                    "title": "Layer",
                    "scale": {
                        "domain": ["Layer I", "Layer II/III", "Layer IV", "Layer V", "Layer VI"],
                        "range": ["square", "cross", "diamond", "triangle-up", "triangle-down"]
                    }
                },
                "color": {
                    "field": "ROItype",
                    "type": "nominal",
                    "legend": {
                        "orient": "bottom",
                        "direction": "vertical"
                    },
                    "title": "ROI Category",
                    "scale": {
                        "domain": ["Cortical layer I", "Cortical layer II/III", "Cortical layer IV", "Cortical layer V", "Cortical layer VI", "NeuN+", "Neuropil"],
                        "range": ["#ccf2f7", "#90cef0", "#37a7e5", "#005b8e", "#002e48", "#f0e442", "#d55e00"]
                    }
                },
                "tooltip": {"field": "type", "type": "ROItype", "title": null}
            }
        }
        }, 
        {
            "Name": "Cortical Cell Type Deconvolution", 
            "Description": "(cortical cell type decon)", 
            "Arrows": [], 
            "Overlays": [], 
            "Group": "All markers", 
            "Masks": ["Cortical layer I", "Cortical layer II/III", "Cortical layer II/III - NeuN+", "Cortical layer II/III - Neuropil", "Cortical layer IV", "Cortical layer IV - NeuN+", "Cortical layer IV - Neuropil", "Cortical layer V", "Cortical layer V - NeuN+", "Cortical layer V - Neuropil", "Cortical layer VI", "Cortical layer VI - NeuN+", "Cortical layer VI - Neuropil"], 
            "ActiveMasks": ["Cortical layer I", "Cortical layer II/III", "Cortical layer II/III - NeuN+", "Cortical layer II/III - Neuropil", "Cortical layer IV", "Cortical layer IV - NeuN+", "Cortical layer IV - Neuropil", "Cortical layer V", "Cortical layer V - NeuN+", "Cortical layer V - Neuropil", "Cortical layer VI", "Cortical layer VI - NeuN+", "Cortical layer VI - Neuropil"], 
            "Zoom": 2.123385226554527, 
            "Pan": [0.27105776403164267, 0.6282803389883898],
            "MaskAndPan": {"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}, "background": null},
            "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
            "layer": 
            [{
               "mark": "bar",
               "data": {"url": "data/wpt7_cortex_decon.csv"},
               "width": "container",
               "encoding": {
                     "x": {
                           "field": "Proportion", 
                           "type": "quantitative", 
                           "stack": "normalize", 
                           "title": "Proportion of Cell Type",
                           "sort": null
                     },
                     "y": {
                           "field": "Sample_ID", 
                           "type": "nominal", 
                           "title": null,
                           "axis": {
                               "labels": false,
                               "ticks": false
                           },
                           "sort": null
                     },
                     "color": {
                           "field": "Cell_type", 
                           "type": "nominal",
                           "legend": {"orient": "bottom", "direction": "vertical", "offset": 750}, 
                           "title": "Cell Type"
                           },
                    "order": {"field": "order"},
                   "tooltip": {
                       "field": "Cell_type", "type":"nominal"
                       }    
                     }
                     
            },
            {
            "data": {
                "values": [
                    {"Sample_ID": "ROI", "order": "M", "name": "Cortical layer I", "type": "Cortical layer I", "percentage": 0.052632},
                    {"Sample_ID": "ROI", "order": "L", "name": "Cortical layer II/III", "type": "Cortical layer II/III", "percentage": 0.078947},
                    {"Sample_ID": "ROI", "order": "K", "name": "NeuN+", "type": "Cortical layer II/III - NeuN+", "percentage": 0.078947},
                    {"Sample_ID": "ROI", "order": "J", "name": "Neuropil", "type": "Cortical layer II/III - Neuropil", "percentage": 0.078947},
                    {"Sample_ID": "ROI", "order": "I", "name": "Cortical layer IV", "type": "Cortical layer IV", "percentage": 0.078947},
                    {"Sample_ID": "ROI", "order": "H", "name": "NeuN+", "type": "Cortical layer IV - NeuN+", "percentage": 0.078947},
                    {"Sample_ID": "ROI", "order": "G", "name": "Neuropil", "type": "Cortical layer IV - Neuropil", "percentage": 0.078947},
                    {"Sample_ID": "ROI", "order": "F", "name": "Cortical layer V", "type": "Cortical layer V", "percentage": 0.078947},
                    {"Sample_ID": "ROI", "order": "E", "name": "NeuN+", "type": "Cortical layer V - NeuN+", "percentage": 0.078947},
                    {"Sample_ID": "ROI", "order": "D", "name": "Neuropil", "type": "Cortical layer V - Neuropil", "percentage": 0.078947},
                    {"Sample_ID": "ROI", "order": "C", "name": "Cortical layer VI", "type": "Cortical layer VI", "percentage": 0.078947},
                    {"Sample_ID": "ROI", "order": "B", "name": "NeuN+", "type": "Cortical layer VI - NeuN+", "percentage": 0.078947},
                    {"Sample_ID": "ROI", "order": "A", "name": "Neuropil", "type": "Cortical layer VI - Neuropil", "percentage": 0.078947}
                ]},
                    "mark": {"type": "bar", "xOffset": -7},
                    "width": 7,
                    "height": 760,
                    "encoding": {
                        "y": {
                                "field": "percentage", 
                                "type": "quantitative",
                                "axis": {
                                "labels": false,
                                "ticks": false
                                },
                                "title": null
                        },
                        "x": {
                                "field": "Sample_ID", 
                                "type": "nominal",     
                                "title": null,
                                "axis": {
                                "labels": false,
                                "ticks": false
                                }
                            },
                        "color": {
                            "field": "name", 
                            "type": "nominal",
                            "sort": null,
                            "legend": {"orient": "top", "direction": "vertical", "title": "Histological Structure"},
                            "scale": {"domain": ["NeuN+", "Neuropil", "Cortical layer I", "Cortical layer II/III", "Cortical layer IV", "Cortical layer V", "Cortical layer VI"], 
                                "range": ["#f0e442", "#d55e00", "#ccf2f7", "#90cef0", "#37a7e5", "#005b8e", "#002e48"]}
                        },
                        "tooltip": {
                            "field": "type", "type":"nominal"
                        },         
                        "order": {"field": "order"}
                    }
            }],
          "resolve": {"scale": {"color": "independent"}}
        }
        }, 
        {
            "Name": "Comparing Gene Expression in Cortical Layers", 
            "Description": "(gene expression in cortical layers)", 
            "Arrows": [], 
            "Overlays": [], 
            "Group": "All markers", 
            "Masks": ["Cortical layer I", "Cortical layer II/III", "Cortical layer IV", "Cortical layer V", "Cortical layer VI"], 
            "ActiveMasks": ["Cortical layer I", "Cortical layer II/III", "Cortical layer IV", "Cortical layer V", "Cortical layer VI"], 
            "Zoom": 2.0190384, 
            "Pan": [0.29276988293172485, 0.6293729646287849],
            "MaskAndPan": {"config": {"axis": {"domain":false}, "view": {"continuousWidth": 400, "continuousHeight": 300}, "background": null}, "width": "container",
            "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
            "layer": [{
                "data": {"url": "data/gene_heatmap_fullRoi_cortex.csv"},
                "mark": "rect",
                "encoding": {
                    "x": {
                        "field": "ROI",
                        "type": "nominal",
                        "title": null,
                        "sort": null,
                        "axis": {
                            "labels": false,
                            "ticks": false
                        }
                    },
                    "y": {
                        "field": "gene",
                        "type": "nominal",
                        "sort": null,
                        "title": null
                    },
                    "color": {
                        "field": "gene_value",
                        "bin": {"binned": true},
                        "scale": {"range": ["#7D26CD", "#6B20AF", "#591B92", "#471575", "#351057", "#230A3A", "#11051D", "#000000", "#212100", "#434300", "#656500", "#888800", "#AAAA00", "#CBCB00", "#EEEE00"]},
                        "legend": {"orient": "top"}, "title": null
                    },
                    "tooltip": {
                        "field": "full_gene_name",
                        "type": "nominal"
                    }
                }
            },
        {
            "data": {
                "values":[
                    {"bar": "one", "order": "A", "type": "Cortical layer I", "percentage": 0.14256},
                    {"bar": "one", "order": "B", "type": "Cortical layer II/III", "percentage": 0.21429},
                    {"bar": "one", "order": "C", "type": "Cortical layer IV", "percentage": 0.21429},
                    {"bar": "one", "order": "D", "type": "Cortical layer V", "percentage": 0.21429},
                    {"bar": "one", "order": "E", "type": "Cortical layer VI", "percentage": 0.21429}
                ]
            },
            "mark": {
                "type": "bar",
                "yOffset": 998
            },
            "encoding": {
                "x": {
                    "field": "percentage",
                    "type": "quantitative",
                    "axis": {
                        "labels": false,
                        "ticks": false
                    },
                    "title": null
                },
                "y": {
                    "field": "bar",
                    "type": "nominal",
                    "title": null,
                    "axis": {
                        "labels": false,
                        "ticks": false
                    }
                },
                "color": {
                    "field": "type",
                    "type": "nominal",
                    "sort":null,
                    "legend": {
                        "title": "ROI Category",
                        "offset":1020,
                        "orient": "bottom",
                        "direction": "vertical"
                    },
                    "scale": {
                        "domain": ["Cortical layer I", "Cortical layer II/III", "Cortical layer IV", "Cortical layer V", "Cortical layer VI"],
                        "range": ["#ccf2f7", "#90cef0", "#37a7e5", "#005b8e", "#002e48"]
                    }
                },
                "order": {"field": "order"},
                "tooltip": {"field": "type", "type": "nominal", "title": null}
                }
        }],
        "resolve": {"scale": {"y": "independent"}}
        }
        }, 
        {
            "Name": "Validating Cortical Gene Expression with Protein Expression", 
            "Description": "(Ighm gene expression plot)\n\nNOTE: The dark blue dots were very hard to see on the black background so I (Natalie) added a white line around them. Let me know if you would prefer a different fix.\n\n![image](img/geneExpressionBelgardeCropped.png)\n\n[*Image credit: Belgrade, et al.*](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3163272/)", 
            "Arrows": [], 
            "Overlays": [], 
            "Group": "All markers", 
            "Masks": ["Cortical layer I", "Cortical layer II/III", "Cortical layer II/III - NeuN+", "Cortical layer II/III - Neuropil", "Cortical layer IV", "Cortical layer IV - NeuN+", "Cortical layer IV - Neuropil", "Cortical layer V", "Cortical layer V - NeuN+", "Cortical layer V - Neuropil", "Cortical layer VI", "Cortical layer VI - NeuN+", "Cortical layer VI - Neuropil"], 
            "ActiveMasks": ["Cortical layer I", "Cortical layer II/III", "Cortical layer II/III - NeuN+", "Cortical layer II/III - Neuropil", "Cortical layer IV", "Cortical layer IV - NeuN+", "Cortical layer IV - Neuropil", "Cortical layer V", "Cortical layer V - NeuN+", "Cortical layer V - Neuropil", "Cortical layer VI", "Cortical layer VI - NeuN+", "Cortical layer VI - Neuropil"], 
            "Zoom": 1.7694876887954394, 
            "Pan": [0.341172485935519, 0.6078795539285848],
            "MaskAndPan": {"config": {"axis": {"domain":false}, "view": {"continuousWidth": 400, "continuousHeight": 300}, "background": null}, "width": "container",
            "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
            "data": {"url": "data/scatter_plot_ighm_expression_cortex.csv"},
            "mark": {"type": "point", "filled": true, "size": 100, "stroke": "white", "strokeWidth": 1},
            "encoding": {
                "x": {
                    "field": "Structure",
                    "type": "quantitative",
                    "axis": {
                        "labelExpr": "datum.label == 1 ? 'Layer I' : datum.label == 2 ? 'Layer II/III' : datum.label == 3 ? 'Layer IV' : datum.label == 4 ? 'Layer V' : datum.label == 5 ? 'Layer VI' : null",
                        "labelAngle": -90,
                        "tickCount": 6,
                        "grid": false
                    },
                    "scale": {"domain": [0, 6]},
                    "title": null
                },
                "y": {
                    "field": "Ighm Expression",
                    "type": "quantitative",
                    "title": "Normalized Ighm Expression"
                },
                "color": {
                    "field": "cortex_layer",
                    "type": "nominal",
                    "legend": {
                        "orient": "bottom",
                        "direction": "vertical",
                        "title": "Cortical Layer"
                    },
                    "scale": {
                        "domain": ["Layer I", "Layer II/III", "Layer IV", "Layer V", "Layer VI", "NeuN+", "Neuropil"],
                        "range": ["#ccf2f7", "#90cef0", "#37a7e5", "#005b8e", "#002e48", "#f0e442", "#d55e00"]
                    }
                },
                "tooltip": [
                    {"field": "Ighm Expression", "type": "quantitative", "format": ".0f"},
                    {"field": "type", "type": "nominal", "title": "ROI cateogry"}
                ]
            }
        }
        }, 
        {
            "Name": "Differential Gene Expression", 
            "Description": "(amygdala vs caudoputamen.)\n\nQuestions from Natalie: Is there a pared list of genes to include on the plot or should I try to manually move these around so they don't overlap? Also, would you like the font size bigger (this will impact the text overlap)?", 
            "Arrows": [], 
            "Overlays": [], 
            "Group": "All markers", 
            "Masks": ["Caudoputamen - NeuN+", "Amygdala - NeuN+"], 
            "ActiveMasks": ["Caudoputamen - NeuN+", "Amygdala - NeuN+"], 
            "Zoom": 1.7002, 
            "Pan": [0.7114, 0.4202],
            "VisBarChart": {"config": {"view": {"continuousWidth": 400, "continuousHeight": 300}, "background": null}, "width": "container", "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
            "data":{
                "url": "data/volcano_plot_Amygdala_left_Caudo_right.csv"
            },
            "layer": [{
                "mark": {"type": "point", "filled": true},
                "encoding": {
                    "x": {
                        "field": "FC",
                        "type": "quantitative",
                        "title": "Amygdala (NeuN+)âlog2(FC)âCaudoputamen (NeuN+)",
                        "axis": {
                            "titleFontSize": 11
                        }
                    },
                    "y": {
                        "field": "Significance",
                        "type": "quantitative",
                        "title": "Significance, -log10(P)"
                    },
                    "color": {
                        "field": "Color",
                        "type": "nominal",
                        "scale": null
                    }
                }
            },
            {
                "mark": {"type": "rect", "fillOpacity": 0, "stroke": "red"},
                "data": {"values": [{"type": "Amygdala - NeuN+"}]},
                "encoding": {
                    "y": {"datum": 1.3},
                    "y2": {"datum": 6},
                    "x": {"datum": -8},
                    "x2": {"datum": -0.5}
                }
            },
            {
                "mark": {"type": "rect", "fillOpacity": 0, "stroke": "red"},
                "data": {"values": [{"type": "Caudoputamen - NeuN+"}]},
                "encoding": {
                    "y": {"datum": 1.3},
                    "y2": {"datum": 6},
                    "x": {"datum": 0.5},
                    "x2": {"datum": 8}
                }
            },
            {
                "mark": {
                    "type": "text",
                    "align": "left",
                    "fontSize": 9,
                    "angle": -35,
                    "color": "white",
                    "stroke": "black",
                    "strokeWidth": 0.1,
                    "baseline": "top"
                },
                "encoding": {
                    "x": {
                        "field": "FC",
                        "type": "quantitative"
                    },
                    "y": {
                        "field": "Significance",
                        "type": "quantitative"
                    },
                    "text": {
                        "field": "GeneNames"
                    }
                }
            }
            ]
            }
        }, 
        {
            "Name": "Gene Expression Across Neuron-Rich ROIs", 
            "Description": "(Drd2 gene expression)\n\n![image](img/Drd2_ADULT.jpg)\n\n[Source: The Gene Expression Nervous System Atlas (GENSAT) Project, NINDS Contracts N01NS02331 & HHSN271200723701C to The Rockefeller University (New York, NY).](http://gensat.org/imagenavigator.jsp?imageID=48609)", 
            "Arrows": [], 
            "Overlays": [], 
            "Group": "All markers", 
            "Masks": ["Amygdala - NeuN+", "Cortical layer II/III - NeuN+", "Cortical layer IV - NeuN+", "Cortical layer V - NeuN+", "Cortical layer VI - NeuN+", "Caudoputamen - NeuN+", "Hippocampus dentate gyrus"], 
            "ActiveMasks": ["Amygdala - NeuN+", "Cortical layer II/III - NeuN+", "Cortical layer IV - NeuN+", "Cortical layer V - NeuN+", "Cortical layer VI - NeuN+", "Caudoputamen - NeuN+", "Hippocampus dentate gyrus"], 
            "Zoom": 0.8412659999999998, 
            "Pan": [0.6418423136177476, 0.49112678437908874],
            "MaskAndPan": {"config": {"axis": {"domain":false}, "view": {"continuousWidth": 400, "continuousHeight": 300}, "background": null}, "width": "container",
            "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
            "data": {"url": "data/scatter_plot_Drd2_expression_neuron_rich.csv"},
            "mark": {"type": "point", "filled": true, "size": 100, "stroke": "white", "strokeWidth": 0.5},
            "encoding": {
                "x": {
                    "field": "Structure",
                    "type": "quantitative",
                    "axis": {
                        "labelExpr": "datum.label == 1 ? 'Amygdala' : datum.label == 2 ? 'Caudoputamen' : datum.label == 3 ? 'Cortex' : datum.label == 4 ? 'Hippocampus' : null",
                        "labelAngle": -90,
                        "tickCount": 4,
                        "grid": false
                    },
                    "scale": {"domain": [0, 5]},
                    "title": null
                },
                "y": {
                    "field": "Drd2 Expression",
                    "type": "quantitative",
                    "title": "Drd2 Expression"
                },
                "shape": {
                    "field": "Layer", 
                    "type": "nominal",
                    "legend": {
                        "orient": "bottom",
                        "direction": "vertical",
                        "symbolFillColor": "white"
                    },
                    "title": "Cortical Layer",
                    "scale": {
                        "domain": ["Cortical layer I", "Cortical layer II/III", "Cortical layer IV", "Cortical layer V", "Cortical layer VI"],
                        "range": ["square", "cross", "diamond", "triangle-up", "triangle-down"]
                    }
                },
                "color": {
                    "field": "type",
                    "type": "nominal",
                    "title": "ROI Category",
                    "legend": {
                        "orient": "bottom",
                        "direction": "vertical"
                    },
                    "scale": {
                        "domain": ["Hippocampus dentate gyrus", "Amygdala - NeuN+", "Cortical layer II/III - NeuN+", "Cortical layer IV - NeuN+", "Cortical layer V - NeuN+", "Cortical layer VI - NeuN+", "Caudoputamen - NeuN+"],
                        "range": ["#01513b", "#f0e442", "#f0e442", "#f0e442", "#f0e442", "#f0e442", "#f0e442"]
                    }
                },
                "tooltip": [
                    {"field": "Drd2 Expression", "type": "quantitative", "format": ".0f"},
                    {"field": "type", "type": "nominal", "title": "ROI cateogry"}
                ]
            }
        }
        }
    ]}], 
    "Masks": [ 
        {"Path": "Amygdala", "Name": "Amygdala", "Colors": ["5c581d"], "Channels": ["Amygdala"]}, 
        {"Path": "Amygdala-NeuN", "Name": "Amygdala - NeuN+", "Colors": ["f0e442"], "Channels": ["Amygdala - NeuN+"]}, 
        {"Path": "Amygdala-Neuropil", "Name": "Amygdala - Neuropil", "Colors": ["d55e00"], "Channels": ["Amygdala - Neuropil"]}, 
        {"Path": "Cortical-layer-I", "Name": "Cortical layer I", "Colors": ["ccf2f7"], "Channels": ["Cortical layer I"]}, 
        {"Path": "Cortical-layer-IIIII", "Name": "Cortical layer II/III", "Colors": ["90cef0"], "Channels": ["Cortical layer II/III"]}, 
        {"Path": "Cortical-layer-IIIII-NeuN", "Name": "Cortical layer II/III - NeuN+", "Colors": ["f0e442"], "Channels": ["Cortical layer II/III - NeuN+"]}, 
        {"Path": "Cortical-layer-IIIII-Neuropil", "Name": "Cortical layer II/III - Neuropil", "Colors": ["d55e00"], "Channels": ["Cortical layer II/III - Neuropil"]}, 
        {"Path": "Cortical-layer-IV", "Name": "Cortical layer IV", "Colors": ["37a7e5"], "Channels": ["Cortical layer IV"]}, 
        {"Path": "Cortical-layer-IV-NeuN", "Name": "Cortical layer IV - NeuN+", "Colors": ["f0e442"], "Channels": ["Cortical layer IV - NeuN+"]}, 
        {"Path": "Cortical-layer-IV-Neuropil", "Name": "Cortical layer IV - Neuropil", "Colors": ["d55e00"], "Channels": ["Cortical layer IV - Neuropil"]}, 
        {"Path": "Cortical-layer-V", "Name": "Cortical layer V", "Colors": ["005b8e"], "Channels": ["Cortical layer V"]}, 
        {"Path": "Cortical-layer-V-NeuN", "Name": "Cortical layer V - NeuN+", "Colors": ["f0e442"], "Channels": ["Cortical layer V - NeuN+"]}, 
        {"Path": "Cortical-layer-V-Neuropil", "Name": "Cortical layer V - Neuropil", "Colors": ["d55e00"], "Channels": ["Cortical layer V - Neuropil"]}, 
        {"Path": "Cortical-layer-VI", "Name": "Cortical layer VI", "Colors": ["002e48"], "Channels": ["Cortical layer VI"]}, 
        {"Path": "Cortical-layer-VI-NeuN", "Name": "Cortical layer VI - NeuN+", "Colors": ["f0e442"], "Channels": ["Cortical layer VI - NeuN+"]}, 
        {"Path": "Cortical-layer-VI-Neuropil", "Name": "Cortical layer VI - Neuropil", "Colors": ["d55e00"], "Channels": ["Cortical layer VI - Neuropil"]}, 
        {"Path": "Caudoputamen", "Name": "Caudoputamen", "Colors": ["a34902"], "Channels": ["Caudoputamen"]}, 
        {"Path": "Caudoputamen-NeuN", "Name": "Caudoputamen - NeuN+", "Colors": ["f0e442"], "Channels": ["Caudoputamen - NeuN+"]}, 
        {"Path": "Caudoputamen-Neuropil", "Name": "Caudoputamen - Neuropil", "Colors": ["d55e00"], "Channels": ["Caudoputamen - Neuropil"]}, 
        {"Path": "Choroid-plexus", "Name": "Choroid plexus", "Colors": ["fdae70"], "Channels": ["Choroid plexus"]}, 
        {"Path": "Hippocampus-CA1", "Name": "Hippocampus CA1", "Colors": ["b9f9e8"], "Channels": ["Hippocampus CA1"]}, 
        {"Path": "Hippocampus-CA2", "Name": "Hippocampus CA2", "Colors": ["00ffba"], "Channels": ["Hippocampus CA2"]}, 
        {"Path": "Hippocampus-CA3", "Name": "Hippocampus CA3", "Colors": ["009e73"], "Channels": ["Hippocampus CA3"]}, 
        {"Path": "Hippocampus-dentate-gyrus", "Name": "Hippocampus dentate gyrus", "Colors": ["01513b"], "Channels": ["Hippocampus dentate gyrus"]}, 
        {"Path": "Hypothalamus", "Name": "Hypothalamus", "Colors": ["beb532"], "Channels": ["Hypothalamus"]}, 
        {"Path": "Ventromedial-hypothalamic-nucleus", "Name": "Ventromedial hypothalamic nucleus", "Colors": ["fff9ad"], "Channels": ["Ventromedial hypothalamic nucleus"]}, 
        {"Path": "Corticospinal-tract", "Name": "Corticospinal tract", "Colors": ["323232"], "Channels": ["Corticospinal tract"]}, 
        {"Path": "Lateral-habenula", "Name": "Lateral habenula", "Colors": ["737373"], "Channels": ["Lateral habenula"]}, 
        {"Path": "Medial-habenula", "Name": "Medial habenula", "Colors": ["cbcbcb"], "Channels": ["Medial habenula"]}, 
        {"Path": "Thalamic-paraventricular-nucleus", "Name": "Thalamic paraventricular nucleus", "Colors": ["784a64"], "Channels": ["Thalamic paraventricular nucleus"]}, 
        {"Path": "Mediodorsal-thalamus", "Name": "Mediodorsal thalamus", "Colors": ["be719c"], "Channels": ["Mediodorsal thalamus"]}, 
        {"Path": "Thalamic-ventral-posteromedial-nucleus", "Name": "Thalamic ventral posteromedial nucleus", "Colors": ["f093c7"], "Channels": ["Thalamic ventral posteromedial nucleus"]}, 
        {"Path": "Thalamus", "Name": "Thalamus", "Colors": ["fec4e4"], "Channels": ["Thalamus"]}
    ], 
    "Groups": [
        {"Name": "All markers", "Path": "All-markers_0__Gfap--1__Nuclei--2__Iba1--3__NeuN", "Colors": ["00ffff", "0000ff", "ffff00", "ff00ff"], "Channels": ["Gfap", "Nuclei", "Iba1", "NeuN"]}, 
        {"Name": "Gfap", "Path": "Gfap_0__Gfap", "Colors": ["00ffff"], "Channels": ["Gfap"]}, 
        {"Name": "Nuclei", "Path": "Nuclei_1__Nuclei", "Colors": ["0000ff"], "Channels": ["Nuclei"]}, 
        {"Name": "Iba1", "Path": "Iba1_2__Iba1", "Colors": ["ffff00"], "Channels": ["Iba1"]}, 
        {"Name": "NeuN", "Path": "NeuN_3__NeuN", "Colors": ["ff00ff"], "Channels": ["NeuN"]}
    ]
}